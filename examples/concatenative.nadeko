;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Minori Yamashita 2013 <ympbyc@gmail.com>
;; Concatenative style
;;
;; inspired by factjor https://github.com/brandonbloom/factjor

(:= (<o) eq?)
(:= (cadr) (compose car cdr))
(:= (cddr) (compose cdr cdr))

(:= (cat stk =>)
    (<o '+ => (cat (cons (+ (car stk) (cadr stk)) (cddr stk)))
    (<o 'end => stk
    (number? =>  (cat (cons => stk))
    nil))))

(car (cat nil 5 6 '+ 7 '+ 8 9 '+ '+ 'end)) ;=> 35
