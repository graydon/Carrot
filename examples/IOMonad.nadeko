;;; IO Monad ;;;

;require prelude

(:= (<o) eq?)

(:= (*world* v w =>)
  (<o 'putStrLn => (-> (s) (*world* (** print s) (++ w v)))
  (<o 'getLine  => (*world* (** read) v)
  (<o 'val      => (++ w v)
  nil))))

(:= (>>= m f) (f m))

(:= (main world)
  (>>= (world 'putStrLn "Hello, what's your name?")
       (-> (world) (>>= (world 'getLine)
                        (-> (world) (world 'putStrLn (++ (++ "Hey " (world 'val)) ", you rock!") 'val))))))

(:= (world) (*world* "" ""))